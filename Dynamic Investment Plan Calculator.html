<!DOCTYPE Posted html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dynamic SIP Calculator</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div id="nav-include"></div>
<script src="common.js"></script>

<div class="box">
<div class="calculator-container">
    <h1>Dynamic SIP Calculator</h1>

    <p class="subtitle"><i> Lets You Enter Different SIP Amount For Every Year</i></p>

    <label>Expected Annual Return (%)</label>
    <input type="number" step="0.01" id="yield" placeholder="e.g. 12" required>

    <label>Number of Years (can be decimal, e.g. 10.5)</label>
    <input type="number" step="0.01" id="years" placeholder="e.g. 10.5" required>

    <button onclick="startSIPEntry()">Start Entering Year-wise SIP Amounts</button>

    <div id="sipInputs"></div>
    <div id="finalMaturity"></div> 
    <div id="details" class="details"></div>
</div>
</div>
<script>
function startSIPEntry() {
    const yield_rate = parseFloat(document.getElementById('yield').value);
    const years = parseFloat(document.getElementById('years').value);

    if (!yield_rate || !years || years <= 0) {
        alert("Please enter valid values");
        return;
    }

    const y = Math.floor(years);
    const part_year = years - y;
    const months = Math.floor(part_year * 12);

    const r = Math.pow(1 + yield_rate/100, 1/12) - 1;
    const rn = Math.pow(1 + r, 12);

    let maturity = 0;
    let sip = 0;
    let logLines = [];

    const container = document.getElementById('sipInputs');
    container.innerHTML = `<h2 class="section-heading">Enter SIP for each year:</h2>`;

    for (let i = 1; i <= y; i++) {
        const div = document.createElement('div');
        div.className = 'year-input';
        div.innerHTML = `<label>Year ${i} SIP Amount (₹)</label>
                             <input type="number" id="sip${i}" placeholder="e.g. 10000" required>`;
        container.appendChild(div);
    }

    const calcBtn = document.createElement('button');
    calcBtn.textContent = "Calculate Maturity";
    calcBtn.onclick = function() {
        logLines = [];
        maturity = 0;

        let lastSip = 0;

        for (let i = 1; i <= y; i++) {
            sip = parseFloat(document.getElementById(`sip${i}`).value) || 0;
            if (sip <= 0) {
                alert(`Please enter valid SIP for Year ${i}`);
                return;
            }

            const end_year = sip * (rn - 1) / r * (1 + r);
            logLines.push(`maturity amount for sip of ${sip.toFixed(2)} at end of ${i}th year is ${end_year.toFixed(2)}`);
            
            const year_maturity = end_year * Math.pow(1 + r, (years - i) * 12);
            logLines.push(` this amount will mature to ${year_maturity.toFixed(2)} after ${(years - i).toFixed(2)} years`);
            
            maturity += year_maturity;
            lastSip = sip;
        }

        // Fractional year
        if (months > 0) {
            const rm = Math.pow(1 + r, months);
            const end = lastSip * (rm - 1) / r * (1 + r);
            maturity += end;
            logLines.push(`\nFractional part (${months} months) with SIP ${lastSip.toFixed(2)} adds ${end.toFixed(2)}`);
        }

        document.getElementById('finalMaturity').innerHTML = 
            `<h2>₹${maturity.toFixed(2)}</h2><p class="final-result-label">Final Maturity Amount</p>`; 
        document.getElementById('finalMaturity').style.display = 'block';

        document.getElementById('details').textContent = logLines.join('\n');
        document.getElementById('details').style.display = 'block';
    };

    container.appendChild(calcBtn);
}
document.querySelector('.hamburger').addEventListener('click', () => {
        document.querySelector('.nav-links').classList.toggle('active');
    });
</script>
</body>
</html>